<div *ngIf="data && metricas" class="p-4 md:p-6">
  <!-- Métricas principales -->
  <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
    <!-- Tarjeta Total Incidentes -->
    <div class="bg-white p-6 rounded-xl shadow-md flex justify-between items-center border-l-4 border-blue-500">
      <div>
        <h3 class="text-lg font-semibold text-gray-700 mb-2">Total Incidentes</h3>
        <p class="text-4xl font-bold text-blue-600 mb-1">{{ formatearNumero(metricas.totalIncidentes) }}</p>
        <div class="text-sm text-green-500 flex items-center gap-1">
          <span class="text-green-600 font-medium">↗ +12%</span>
          <span class="text-gray-500">vs mes anterior</span>
        </div>
      </div>
      <div class="bg-blue-50 p-3 rounded-full">
        <!-- Warning/Alert Triangle Icon SVG -->
        <svg class="w-8 h-8 text-blue-500" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M10.29 3.86L1.82 18C1.64571 18.3024 1.55299 18.6453 1.55201 18.9945C1.55103 19.3437 1.64171 19.6871 1.81442 19.9905C1.98714 20.2939 2.23584 20.5468 2.53621 20.7239C2.83658 20.901 3.18035 20.9962 3.53 21H20.47C20.8197 20.9962 21.1634 20.901 21.4638 20.7239C21.7642 20.5468 22.0129 20.2939 22.1856 19.9905C22.3583 19.6871 22.449 19.3437 22.448 18.9945C22.447 18.6453 22.3543 18.3024 22.18 18L13.71 3.86C13.5317 3.56611 13.2807 3.32312 12.9812 3.15448C12.6817 2.98585 12.3438 2.89725 12 2.89725C11.6562 2.89725 11.3183 2.98585 11.0188 3.15448C10.7193 3.32312 10.4683 3.56611 10.29 3.86V3.86Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          <path d="M12 9V13" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          <path d="M12 17H12.01" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      </div>
    </div>

    <!-- Tarjeta Total Objetos Encontrados -->
    <div class="bg-white p-6 rounded-xl shadow-md flex justify-between items-center border-l-4 border-green-500">
      <div>
        <h3 class="text-lg font-semibold text-gray-700 mb-2">Objetos Encontrados</h3>
        <p class="text-4xl font-bold text-green-600 mb-1">{{ formatearNumero(metricas.totalObjetos) }}</p>
        <div class="text-sm text-green-500 flex items-center gap-1">
          <span class="text-green-600 font-medium">↗ +8%</span>
          <span class="text-gray-500">vs mes anterior</span>
        </div>
      </div>
      <div class="bg-green-50 p-3 rounded-full">
        <!-- Package/Box Icon SVG -->
        <svg class="w-8 h-8 text-green-500" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M16.5 9.4L7.5 4.21C7.18 4.05 6.82 4.05 6.5 4.21L2.5 6.11C2.22 6.26 2 6.55 2 6.89V17.11C2 17.45 2.22 17.74 2.5 17.89L6.5 19.79C6.82 19.95 7.18 19.95 7.5 19.79L11.5 17.89C11.78 17.74 12 17.45 12 17.11V6.89C12 6.55 11.78 6.26 11.5 6.11L16.5 9.4Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          <path d="M22 12L12 7L2 12L12 17L22 12Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          <path d="M2 12L12 17L22 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      </div>
    </div>

    <!-- Tarjeta Porcentaje Resueltos -->
    <div class="bg-white p-6 rounded-xl shadow-md flex justify-between items-center border-l-4 border-indigo-500">
      <div>
        <h3 class="text-lg font-semibold text-gray-700 mb-2">Tasa de Resolución</h3>
        <p class="text-4xl font-bold text-indigo-600 mb-1">{{ formatearPorcentaje(metricas.porcentajeResolucion) }}</p>
        <div class="text-sm text-green-500 flex items-center gap-1">
          <span class="text-green-600 font-medium">↗ +5%</span>
          <span class="text-gray-500">vs mes anterior</span>
        </div>
      </div>
      <div class="bg-indigo-50 p-3 rounded-full">
        <!-- Check Circle Icon SVG -->
        <svg class="w-8 h-8 text-indigo-500" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M9 12L11 14L15 10" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          <path d="M21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12Z" stroke="currentColor" stroke-width="2"/>
        </svg>
      </div>
    </div>
  </div>

  <!-- Gráficos principales -->
  <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
    <!-- Incidentes por Laboratorio -->
    <div class="bg-white p-6 rounded-xl shadow-md border border-gray-100">
      <div class="flex items-center justify-between mb-4">
        <h3 class="text-lg font-semibold text-gray-700 flex items-center gap-2">
          <div class="bg-blue-50 p-2 rounded-lg">
            <!-- Bar Chart Icon SVG -->
            <svg class="w-5 h-5 text-blue-500" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <line x1="12" y1="20" x2="12" y2="10" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
              <line x1="18" y1="20" x2="18" y2="4" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
              <line x1="6" y1="20" x2="6" y2="16" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            </svg>
          </div>
          Incidentes por Laboratorio
        </h3>
      </div>
      <div class="h-64 relative">
        <canvas baseChart
                [data]="incidentesLaboratorioChart"
                [options]="barChartOptions"
                [type]="barChartType">
        </canvas>
      </div>
    </div>

    <!-- Incidentes por Estado -->
    <div class="bg-white p-6 rounded-xl shadow-md border border-gray-100">
      <div class="flex items-center justify-between mb-4">
        <h3 class="text-lg font-semibold text-gray-700 flex items-center gap-2">
          <div class="bg-pink-50 p-2 rounded-lg">
            <!-- Pie Chart Icon SVG -->
            <svg class="w-5 h-5 text-pink-500" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M21.21 15.89C20.5738 17.3945 19.5788 18.7202 18.3119 19.7513C17.0449 20.7824 15.5447 21.4874 13.9424 21.8048C12.3401 22.1221 10.6844 22.0421 9.12012 21.5718C7.55585 21.1014 6.1306 20.2551 4.97918 19.1037C3.82777 17.9523 2.98151 16.5271 2.51118 14.9628C2.04084 13.3986 1.96083 11.7428 2.27818 10.1405C2.59552 8.53825 3.30056 7.03809 4.33162 5.77109C5.36269 4.50409 6.68836 3.50913 8.19279 2.87299" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              <path d="M22 12C22 10.6868 21.7413 9.38642 21.2388 8.17317C20.7362 6.95991 19.9997 5.85752 19.0711 4.92893C18.1425 4.00035 17.0401 3.26375 15.8268 2.7612C14.6136 2.25866 13.3132 2 12 2V12H22Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </div>
          Estado de Incidentes
        </h3>
      </div>
      <div class="h-64 relative">
        <canvas baseChart
                [data]="incidentesEstadoChart"
                [options]="pieChartOptions"
                [type]="pieChartType">
        </canvas>
      </div>
    </div>

    <!-- Tendencia de Incidentes por Mes -->
    <div class="bg-white p-6 rounded-xl shadow-md border border-gray-100">
      <div class="flex items-center justify-between mb-4">
        <h3 class="text-lg font-semibold text-gray-700 flex items-center gap-2">
          <div class="bg-purple-50 p-2 rounded-lg">
            <!-- Line Chart Icon SVG -->
            <svg class="w-5 h-5 text-purple-500" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M3 3V21H21" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              <path d="M9 9L12 6L16 10L20 6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </div>
          Tendencia Mensual
        </h3>
      </div>
      <div class="h-64 relative">
        <canvas baseChart
                [data]="tendenciaChart"
                [options]="lineChartOptions"
                [type]="lineChartType">
        </canvas>
      </div>
    </div>

    <!-- Incidentes por Tipo de Inconveniente -->
    <div class="bg-white p-6 rounded-xl shadow-md border border-gray-100">
      <div class="flex items-center justify-between mb-4">
        <h3 class="text-lg font-semibold text-gray-700 flex items-center gap-2">
          <div class="bg-orange-50 p-2 rounded-lg">
            <!-- Bar Chart Icon SVG -->
            <svg class="w-5 h-5 text-orange-500" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <line x1="12" y1="20" x2="12" y2="10" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
              <line x1="18" y1="20" x2="18" y2="4" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
              <line x1="6" y1="20" x2="6" y2="16" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            </svg>
          </div>
          Tipos de Inconvenientes
        </h3>
      </div>
      <div class="h-64 relative">
        <canvas baseChart
                [data]="incidentesInconvenienteChart"
                [options]="barChartOptions"
                [type]="barChartType">
        </canvas>
      </div>
    </div>

    <!-- Objetos Perdidos por Laboratorio -->
    <div class="bg-white p-6 rounded-xl shadow-md border border-gray-100">
      <div class="flex items-center justify-between mb-4">
        <h3 class="text-lg font-semibold text-gray-700 flex items-center gap-2">
          <div class="bg-green-50 p-2 rounded-lg">
            <!-- Bar Chart Icon SVG -->
            <svg class="w-5 h-5 text-green-500" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <line x1="12" y1="20" x2="12" y2="10" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
              <line x1="18" y1="20" x2="18" y2="4" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
              <line x1="6" y1="20" x2="6" y2="16" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            </svg>
          </div>
          Objetos por Laboratorio
        </h3>
      </div>
      <div class="h-64 relative">
        <canvas baseChart
                [data]="objetosLaboratorioChart"
                [options]="barChartOptions"
                [type]="barChartType">
        </canvas>
      </div>
    </div>

    <!-- Objetos Perdidos por Estado -->
    <div class="bg-white p-6 rounded-xl shadow-md border border-gray-100">
      <div class="flex items-center justify-between mb-4">
        <h3 class="text-lg font-semibold text-gray-700 flex items-center gap-2">
          <div class="bg-yellow-50 p-2 rounded-lg">
            <!-- Pie Chart Icon SVG -->
            <svg class="w-5 h-5 text-yellow-500" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M21.21 15.89C20.5738 17.3945 19.5788 18.7202 18.3119 19.7513C17.0449 20.7824 15.5447 21.4874 13.9424 21.8048C12.3401 22.1221 10.6844 22.0421 9.12012 21.5718C7.55585 21.1014 6.1306 20.2551 4.97918 19.1037C3.82777 17.9523 2.98151 16.5271 2.51118 14.9628C2.04084 13.3986 1.96083 11.7428 2.27818 10.1405C2.59552 8.53825 3.30056 7.03809 4.33162 5.77109C5.36269 4.50409 6.68836 3.50913 8.19279 2.87299" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              <path d="M22 12C22 10.6868 21.7413 9.38642 21.2388 8.17317C20.7362 6.95991 19.9997 5.85752 19.0711 4.92893C18.1425 4.00035 17.0401 3.26375 15.8268 2.7612C14.6136 2.25866 13.3132 2 12 2V12H22Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </div>
          Estado de Objetos
        </h3>
      </div>
      <div class="h-64 relative">
        <canvas baseChart
                [data]="objetosEstadoChart"
                [options]="pieChartOptions"
                [type]="pieChartType">
        </canvas>
      </div>
    </div>
  </div>

  <!-- Estado de carga mejorado -->
  <div *ngIf="!data || !metricas" class="flex flex-col items-center justify-center py-20 text-center">
    <div class="relative">
      <div class="animate-spin rounded-full h-12 w-12 border-4 border-blue-200 border-t-blue-600 mb-4"></div>
      <div class="absolute inset-0 rounded-full border-4 border-transparent border-t-blue-300 animate-ping"></div>
    </div>
    <p class="text-gray-600 text-lg font-medium">Cargando datos del dashboard...</p>
    <p class="text-gray-400 text-sm mt-1">Esto puede tomar unos segundos</p>
  </div>
</div>
